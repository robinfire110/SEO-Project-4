{% extends "layout.html" %}
{% block content %}
<!-- partial:index.partial.html -->
<h1>
  My Items
</h1>
<p>
</p>
<main>
  <table>
    <thead>
      <tr>
        <th>
          Food Item
        </th>
        <th>
          Expiration Date
        </th>
        <th>Remove</th>
      </tr>
    </thead>
    <tbody id="table"></tbody>
    <tfoot>
      <tr>
        <th colspan='3'>
          Notifood
        </th>
      </tr>
    </tfoot>
  </table>
  </div>
</main>
<!-- partial -->
<script text="type/javascript"> 
    //Variables
    const table = document.getElementById('table');
    const data = {{ data|safe }}

    //Create Table
    for (i = 0; i < data.length; i++) {
      currentData = data[i];
      html = "";
      html += `<tr>`;
      html += `<td>${currentData[2]}</td>`;
      html += `<td>${(currentData[1]).replace(" 00:00:00", "")}</td>`;
      html += `<td><a class='button' id='${currentData[2]}' href='' onclick='deleteFood("${currentData[2]}")'>Remove</a></td>`;
      html += `</tr>`;
      table.innerHTML += html;  
      //document.getElementById(`${currentData[2]}`).addEventListener("click", deleteFood(currentData[2]))
    }

    //Delete Request
    function deleteFood(name){
      c_url = window.location.href+"/delete/"+name
      fetch(c_url, {
          method: "DELETE",
          headers: {
              'Content-type': 'application/json'
          }
      })
    }
    

    
  </script>
{% endblock content %}


